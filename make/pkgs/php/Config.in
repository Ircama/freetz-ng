menuconfig FREETZ_PACKAGE_PHP
	bool "PHP (binary only)"
	depends on FREETZ_TARGET_GCC_8_MIN
	default n
	select FREETZ_LIB_libxml2 if !FREETZ_PACKAGE_PHP_STATIC
	select FREETZ_LIB_libpcre2 if !FREETZ_PACKAGE_PHP_STATIC
	select FREETZ_LIB_libonig if !FREETZ_PACKAGE_PHP_STATIC
	select FREETZ_LIB_libintl if !FREETZ_PACKAGE_PHP_STATIC
	select FREETZ_LIB_libz if !FREETZ_PACKAGE_PHP_STATIC
	help
		PHP: Hypertext Preprocessor
		PHP is a widely-used general-purpose scripting language that is especially
		suited for Web development and can be embedded into HTML.

		Note: This conflicts with PHP5 - only one can be selected.

		Note: PHP 8.5+ requires GCC 8.x or newer due to modern C language features,
		atomic operations, and compiler intrinsics requirements.
		For older toolchains (GCC 4.x-7.x), please use PHP 8.3.x or earlier instead.

if FREETZ_PACKAGE_PHP

choice
	prompt "PHP Version"
	default FREETZ_PACKAGE_PHP_VERSION_8_5

	config FREETZ_PACKAGE_PHP_VERSION_8_4
		bool "PHP 8.4.1"
		help
			PHP 8.4.1 - Stable release with all 8.4.x features

	config FREETZ_PACKAGE_PHP_VERSION_8_5
		bool "PHP 8.5.0"
		help
			PHP 8.5.0 - Latest release with new features

endchoice

menu "Binaries"

config FREETZ_PACKAGE_PHP_cgi
	bool "PHP CGI"
	default y

config FREETZ_PACKAGE_PHP_cli
	bool "PHP CLI"
	default y

config FREETZ_PACKAGE_PHP_fpm
	bool "PHP-FPM"
	default n
	help
		Enable the FastCGI Process Manager (FPM) for PHP.
		PHP-FPM is a FastCGI server implementation for high-traffic sites.

endmenu

menu "PHP features"

config FREETZ_PACKAGE_PHP_WITH_BCMATH
	bool "BCMATH support"
	default n
	help
		Enables arbitrary precision mathematics for financial and cryptographic calculations

config FREETZ_PACKAGE_PHP_WITH_BZ2
	bool "BZ2 support (libbz2.so.1)"
	select FREETZ_LIB_libbz2 if !FREETZ_PACKAGE_PHP_STATIC
	default n
	help
		Enables bzip2 compression/decompression (libbz2.so.1)

config FREETZ_PACKAGE_PHP_WITH_CALENDAR
	bool "CALENDAR support"
	default n
	help
		Enables calendar conversion functions (Gregorian, Julian, Hebrew, etc.)

config FREETZ_PACKAGE_PHP_WITH_CTYPE
	bool "CTYPE support"
	default y
	help
		Enables character type checking functions (ctype_alnum, ctype_digit, etc.)

config FREETZ_PACKAGE_PHP_WITH_CURL
       bool "CURL support (libcurl.so.4)"
       select FREETZ_LIB_libcurl if !FREETZ_PACKAGE_PHP_STATIC
       default n
       help
	       Enables HTTP/HTTPS/FTP client functionality (libcurl.so.4)

config FREETZ_PACKAGE_PHP_WITH_DOM
	bool "DOM support (libxml2.so.16)"
	select FREETZ_PACKAGE_PHP_WITH_LIBXML
	select FREETZ_LIB_libxml2_WITH_RELAXNG if !FREETZ_PACKAGE_PHP_STATIC
	default n
	help
		Enables Document Object Model for XML/HTML manipulation (requires LIBXML)
		Note: Tree manipulation API is always included in libxml2 2.15.x

config FREETZ_PACKAGE_PHP_WITH_EXIF
	bool "EXIF support"
	default n
	help
		Enables reading EXIF metadata from JPEG/TIFF images (camera info, GPS, etc.)

config FREETZ_PACKAGE_PHP_WITH_FILEINFO
	bool "FILEINFO support"
	default n
	help
		This option enables the FILEINFO support for PHP

config FREETZ_PACKAGE_PHP_WITH_FTP
	bool "FTP support"
	default n
	help
		This option enables the FTP support for PHP

config FREETZ_PACKAGE_PHP_WITH_GD
       bool "GD support (libgd.so.3, libpng, libjpeg, libfreetype)"
       select FREETZ_LIB_libgd
       default n
       help
	       Enables image manipulation and creation (libgd.so.3, requires libpng, libjpeg, libfreetype)

config FREETZ_PACKAGE_PHP_WITH_GETTEXT
       bool "gettext support (libintl.so.8)"
       depends on !FREETZ_TARGET_UCLIBC_0_9_28 && !FREETZ_TARGET_UCLIBC_0_9_29 && !FREETZ_TARGET_UCLIBC_0_9_32 && !FREETZ_TARGET_UCLIBC_0_9_33
       default n
       help
	       Enables internationalization and localization (libintl.so.8, requires intl library not available in old uClibc)

config FREETZ_PACKAGE_PHP_WITH_ICONV
	bool "ICONV support (libiconv.so.2 or uClibc built-in)"
	select FREETZ_LIB_libiconv if !FREETZ_PACKAGE_PHP_STATIC
	default n
	help
		Enables character set conversion (uses uClibc built-in or libiconv.so.2)

config FREETZ_PACKAGE_PHP_WITH_LIBICONV
       bool "Use libiconv instead of uClibc iconv"
       depends on FREETZ_TARGET_UCLIBC_0_9_28
       default n
       select FREETZ_LIB_libiconv if !FREETZ_PACKAGE_PHP_STATIC
       help
	       Use libiconv library instead of uClibc's built-in iconv.
	       Note: This option is only available with uClibc 0.9.28.

config FREETZ_PACKAGE_PHP_WITH_LIBXML
       bool "LIBXML support (libxml2.so.16)"
       default n
       help
	       Enables XML parsing and manipulation (libxml2.so.16)

config FREETZ_PACKAGE_PHP_WITH_MBSTRING
	bool "MBSTRING support (libonig.so.5)"
	default y
	help
		Enables multi-byte string functions (libonig.so.5 for regex support)

config FREETZ_PACKAGE_PHP_WITH_MYSQLI
	bool "MySQLi support (libmysqlclient.so or libmariadb.so)"
	depends on FREETZ_SHOW_DEVELOPER
	default n
	help
		Enables MySQL/MariaDB database access (libmysqlclient.so or libmariadb.so)

config FREETZ_PACKAGE_PHP_WITH_OPCACHE
	bool "OPcache support"
	default y
	help
		This option enables the OPcache support for PHP

config FREETZ_PACKAGE_PHP_WITH_OPENSSL
       bool "OpenSSL support (libssl.so.3, libcrypto.so.3)"
       default n
       help
	       Enables cryptography and SSL/TLS (libssl.so.3, libcrypto.so.3)

config FREETZ_PACKAGE_PHP_WITH_PCNTL
	bool "PCNTL support"
	default n
	help
		This option enables the PCNTL support for PHP

config FREETZ_PACKAGE_PHP_WITH_PHAR
	bool "PHAR support"
	default n
	help
		Enables PHP Archive (PHAR) support for bundled PHP applications

config FREETZ_PACKAGE_PHP_WITH_POSIX
	bool "POSIX support"
	default n
	help
		Enables POSIX functions (getpid, setuid, getgid, etc.)

config FREETZ_PACKAGE_PHP_WITH_READLINE
	bool "READLINE support (libreadline.so.8, libncurses.so.6)"
	select FREETZ_LIB_libreadline if !FREETZ_PACKAGE_PHP_STATIC
	select FREETZ_LIB_libncurses if !FREETZ_PACKAGE_PHP_STATIC
	default n
	help
		Enables readline support for interactive PHP CLI (libreadline.so.8, libncurses.so.6)

config FREETZ_PACKAGE_PHP_WITH_PDO
	bool "PDO support"
	default y
	help
		This option enables the PDO support for PHP

config FREETZ_PACKAGE_PHP_WITH_PDO_SQLITE
       bool "PDO SQLite support (libsqlite3.so.3)"
       select FREETZ_LIB_libsqlite3 if !FREETZ_PACKAGE_PHP_STATIC
       default n
       help
	       Enables SQLite database access via PDO (libsqlite3.so.3)

config FREETZ_PACKAGE_PHP_WITH_SESSION
	bool "SESSION support"
	default y
	help
		This option enables the SESSION support for PHP

config FREETZ_PACKAGE_PHP_WITH_SHMOP
	bool "SHMOP support"
	default n
	help
		Enables shared memory operations for inter-process communication

config FREETZ_PACKAGE_PHP_WITH_SIMPLEXML
       bool "SimpleXML support (libxml2.so.16)"
       default n
       help
	       Enables SimpleXML for easy XML parsing (libxml2.so.16)

config FREETZ_PACKAGE_PHP_WITH_SOCKETS
	bool "SOCKETS support"
	default n
	help
		This option enables the SOCKETS support for PHP

config FREETZ_PACKAGE_PHP_WITH_SQLITE3
       bool "SQLite3 support (libsqlite3.so.3)"
       select FREETZ_LIB_libsqlite3 if !FREETZ_PACKAGE_PHP_STATIC
       default n
       help
	       Enables SQLite3 database access (libsqlite3.so.3)

config FREETZ_PACKAGE_PHP_WITH_SYSVIPC
	bool "System V IPC support"
	default n
	help
		This option enables the System V IPC support for PHP

config FREETZ_PACKAGE_PHP_WITH_ZLIB
	bool "ZLIB support (libz.so.1)"
	select FREETZ_LIB_libz if !FREETZ_PACKAGE_PHP_STATIC
	default y
	help
		Enables ZLIB compression (libz.so.1)

config FREETZ_PACKAGE_PHP_WITH_ZIP
       bool "ZIP support"
       default n
       help
	       This option enables the ZIP support for PHP

endmenu

menu "Build options"

config FREETZ_PACKAGE_PHP_WITH_LIBXML2_FULL
	bool "Enable libxml2 full feature set"
	select FREETZ_LIB_libxml2_WITH_RELAXNG if !FREETZ_PACKAGE_PHP_STATIC
	default y
	help
		Build libxml2 with full feature set (--with-minimum=no).
		
		PHP may require additional libxml2 features beyond basic XML parsing
		for full DOM, SimpleXML, and XMLReader/XMLWriter functionality.
		
		Size impact: Adds ~200-300 KB to libxml2.so
		
		Benefits:
		- Full PHP XML extension support
		- Complete DOM manipulation capabilities
		- All XMLReader/XMLWriter features
		
		Disable only if:
		- Device has very limited flash space
		- Only basic XML parsing is needed
		- XML extensions are not used
		
		Note: Disabling may cause missing symbols or limited functionality
		in PHP's XML-related extensions.

config FREETZ_PACKAGE_PHP_WITH_LIBXML2_HTML
	bool "Enable libxml2 HTML support"
	select FREETZ_LIB_libxml2_WITH_HTML if !FREETZ_PACKAGE_PHP_STATIC
	default y
	help
		Enable HTML parsing capabilities in libxml2.
		
		Required for PHP's DOMDocument to load and parse HTML content,
		which is commonly needed for web scraping and HTML manipulation.
		
		Size impact: Adds ~120 KB to libxml2.so
		
		Disable if HTML parsing is not needed in your PHP applications.

config FREETZ_PACKAGE_PHP_WITH_PCRE2_JIT
	bool "Enable PCRE2 JIT compilation"
	select FREETZ_LIB_libpcre2_WITH_JIT if !FREETZ_PACKAGE_PHP_STATIC
	depends on !FREETZ_KERNEL_VERSION_2_6_39_3
	default y
	help
		Enable Just-In-Time compilation in PCRE2 for faster regex execution.
		
		PHP 8.x heavily uses PCRE2 for regular expressions (preg_* functions).
		JIT compiles regex patterns to native code for significant performance gains.
		
		Size impact: Adds ~100-150 KB to libpcre2-8.so
		
		Benefits:
		- 2-10x faster regex execution
		- Eliminates runtime warnings about missing JIT
		- Recommended for production PHP environments
		
		Disable only if:
		- Device has very limited flash space
		- Regex performance is not critical
		
		Note: Not available on kernel 2.6.39.3 (JIT compilation issue).
		Disabling may cause PHP to show warnings about PCRE2 JIT not available.

config FREETZ_PACKAGE_PHP_OMIT_PHPINFO_CONFIGURE
	bool "Omit configure command from phpinfo()"
	default y
	help
		Removes the full configure command from phpinfo() output.
		
		Benefits:
		- Reduces binary size slightly (~200 bytes)
		- Avoids exposing build system paths for security
		- Cleaner phpinfo() output
		
		Disable only if you need to debug build configuration issues.

config FREETZ_PACKAGE_PHP_STATIC
	bool "Link statically"
	default n
	help
		Causes all libraries PHP depends on to be linked in statically

endmenu

endif
